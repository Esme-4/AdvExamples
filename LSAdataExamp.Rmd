---
title: "LSAdata OneWay ANOVA"
author: "F.A. Barrios"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown:
    highlight: kate
    toc: TRUE
---

```{r setup, include=FALSE}
library(knitr)
library(rmdformats)

## Global options
options(max.print="80")
opts_chunk$set(echo=TRUE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=FALSE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=80)
```
```{r}
# Set working directory
setwd("~/Dropbox/GitHub/ProbEstad2021")

# loading libraries
library(tidyverse)
library(car)
library(emmeans)
library(rstatix)
library(multcomp)
library(ggstatsplot)
library(scales)
```

## LDS Daniel chap 8  LSADATA
One-way ANOVA exercises with large data sets.  
Refer to the serum lipid-bound sialic acid data on 1400 subjects (LSADATA). We wish to conduct a study to determine if the measurement of serum lipid-bound sialic acid (LSA) might be of use in the detection of breast cancer. The LSA measurements (mg/dl) are for four populations of subjects: normal controls, A; patients with benign breast disease, B; patients with primary breast cancer, C; and patients with recurrent metastatic breast cancer, D. Select a simple random sample of size 10 from each population and perform an appropriate analysis to determine if we may conclude that the four population means are different.Let $ \alpha = .05$ and determine the p value.  

## data import and tibble format  

First we read the large data set (LDS) for the serum lipid-bound sialic acid data on 1400 subjects (LSADATA).  

```{r}
LSAdata <- read_csv("DataSets/ch08_all/LDS_C08_LSADATA.csv")
LSAdata
```

Now change the column names according to the LDS description: Subject_number:Col1, Controls:Col2 patients with benign breast disease (BBD):Col3, patients with primary breast cancer (PBC):Col4 patients with recurrent metastatic breast cancer (RMBC)  
The original data is in table form and we need to change it to "long" format. And then to do the ANOVA we need to make the `Type` of cancer variable a factor and then re-level to group and compare to `Cont.  

``{r}
# Make LSAdata long
LSAdata_long <- LSAdata_n %>%
  pivot_longer(cols = everything(), names_to = "Type", values_to = "LSA")
  
# Make the Type variable a factor and re-level to compare to Cont
LSAdata_long <- LSAdata_long %>% 
  mutate( Type = factor(Type) )
LSAdata_long <- LSAdata_long %>% 
  mutate( Type = Type %>% fct_relevel("Cont","BBD","PBC","RMBC") )

```

## Box Plots  

Simple way to see if the data is in the correct format, a simple "direct" plot will generate the "correct" plot (BoxPlot) is the tibble is in the correct format `boxplot(LSA ~ Type, data = LSAdata_long)`.  

```{r}
# boxplot(LSA ~ Type, data = LSAdata_long)
# nicer
LSAdata_long %>% ggplot(aes(x = Type, y = LSA)) +
    geom_boxplot() +
#   geom_violin(draw_quantiles = c(0.25, 0.5, 0.75), scale = "area") +
    geom_jitter(aes(colour = Type), shape = 16, position = position_jitter(seed = 123)) +
    labs(title = "Measurement of serum Lipid-bound Sialic Acid (LSA)") +
    theme_bw()
              
```

